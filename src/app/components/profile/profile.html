<div class="profile-container">
      <!-- Loading State -->
      <div *ngIf="loading" class="loading-state">
        <div class="spinner"></div>
        <p *ngIf="isOwnProfile">Loading your profile...</p>
        <p *ngIf="!isOwnProfile">Loading the profile...</p>
      </div>

      <!-- Profile Content -->
      <div *ngIf="!loading && userProfile" class="profile-content">
        <!-- Profile Header -->
        <div class="profile-header">
          <div class="avatar-section">
            <div class="avatar-container">
              <img [src]="userProfile.photoURL || defaultAvatar" [alt]="userProfile.name" class="avatar">
              <!-- Level Badge -->
              <div class="level-badge">
                <span class="level-number">{{ userProfile.level || 1 }}</span>
              </div>
            </div>
          </div>
          
          <div class="profile-info">
            <div class="name-section">
              <h1 *ngIf="!editingName" class="user-name" (click)="startEditingName()">
                {{ userProfile.name || 'Anonymous User' }}
                <span class="edit-icon" *ngIf="isOwnProfile">‚úèÔ∏è</span>
              </h1>
              <div *ngIf="editingName" class="name-edit">
                <input 
                  [(ngModel)]="tempName" 
                  class="name-input"
                  (keydown)="onKeyDown($event, 'name-edit')"
                  (input)="onNameInput()"
                  maxlength="50"
                  placeholder="Enter your name"
                  #nameInput>
                <div class="edit-actions">
                  <button class="save-btn" (click)="saveName()" [disabled]="savingProfile">
                    {{ savingProfile ? 'Saving...' : 'Save' }}
                  </button>
                  <button class="cancel-btn" (click)="cancelNameEdit()">Cancel</button>
                </div>
              </div>
            </div>

            <!-- Enhanced Writing Streak Section -->
            <div class="streak-section" *ngIf="userProfile.writingStreak && userProfile.writingStreak > 0">
  <div class="streak-indicator" [class.streak-warning]="!isStreakCurrent()">
    <span class="streak-icon">{{ getStreakIcon(userProfile.writingStreak) }}</span>
    {{ userProfile.writingStreak }}-day writing streak
    <span class="streak-status" *ngIf="!isStreakCurrent()">‚ö†Ô∏è At Risk</span>
  </div>
  <small class="streak-info" *ngIf="userProfile.lastWriteDate">
    Last activity: {{ formatDate(userProfile.lastWriteDate) }}
  </small>
</div>

            <!-- XP Progress -->
     <!-- XP Progress -->
<div class="xp-section">
  <div class="xp-info">
    <span class="xp-current">{{ userProfile.xp || 0 }} XP</span>
    <span class="xp-next">{{ getXPNeededForNextLevel() }} XP to level {{ (userProfile.level || 1) + 1 }}</span>
  </div>
  <div class="xp-bar">
    <div class="xp-progress" [style.width.%]="getXPProgress()"></div>
  </div>
  <div class="xp-details" *ngIf="!loadingStats">
    <small class="level-info">Level {{ userProfile.level || 1 }} ‚Ä¢ {{ getXPProgress() | number:'1.1-1' }}% to next level</small>
  </div>
</div>
            
            <div class="bio-section">
              <p *ngIf="!editingBio" class="user-bio" (click)="startEditingBio()">
                {{ userProfile.bio || 'No bio added yet. Click to add one!' }}
                <span class="edit-icon" *ngIf="isOwnProfile">‚úèÔ∏è</span>
              </p>
              <div *ngIf="editingBio" class="bio-edit">
                <textarea 
                  [(ngModel)]="tempBio" 
                  class="bio-textarea"
                  rows="3"
                  (keydown)="onKeyDown($event, 'bio-edit')"
                  (input)="onBioInput()"
                  maxlength="200"
                  placeholder="Tell us about yourself..."
                  #bioInput></textarea>
                <div class="edit-actions">
                  <button class="save-btn" (click)="saveBio()" [disabled]="savingProfile">
                    {{ savingProfile ? 'Saving...' : 'Save' }}
                  </button>
                  <button class="cancel-btn" (click)="cancelBioEdit()">Cancel</button>
                </div>
              </div>
            </div>
            



<!-- Add this section after the bio-section in your profile.html -->
<div class="social-section">
  <h4 class="social-title" *ngIf="!editingSocial">
    Social Links
    <span class="edit-icon" *ngIf="isOwnProfile" (click)="startEditingSocial()">‚úèÔ∏è</span>
  </h4>

  <!-- Display Mode -->
  <div *ngIf="!editingSocial" class="social-links-display">
    <div *ngIf="!hasSocialLinks() && isOwnProfile" 
         class="social-placeholder"
         (click)="startEditingSocial()">
      <span class="placeholder-text">Add your social links</span>
      <span class="edit-icon">‚úèÔ∏è</span>
    </div>
    
    <div *ngIf="hasSocialLinks()" class="social-links-grid">
      <!-- Facebook -->
      <div class="social-link-wrapper">
        <a *ngIf="userProfile.socialLinks?.fb" 
           [href]="getSocialUrl('fb', userProfile.socialLinks.fb)" 
           target="_blank" 
           rel="noopener noreferrer"
           class="social-link facebook">
           <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
             <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 
                      5.373-12 12c0 5.99 4.388 10.954 10.125 
                      11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 
                      1.792-4.669 4.533-4.669 1.312 0 
                      2.686.235 2.686.235v2.953H15.83c-1.491 
                      0-1.956.925-1.956 1.874v2.25h3.328l-.532 
                      3.47h-2.796v8.385C19.612 23.027 
                      24 18.062 24 12.073z"/>
           </svg>
        </a>
        <button *ngIf="userProfile.socialLinks?.fb && isOwnProfile" 
                class="edit-social-btn" 
                (click)="editSingleSocial('fb')"
                title="Edit Facebook link">
          ‚úèÔ∏è
        </button>
      </div>
      
      <!-- Instagram -->
      <div class="social-link-wrapper">
        <a *ngIf="userProfile.socialLinks?.ig" 
           [href]="getSocialUrl('ig', userProfile.socialLinks.ig)" 
           target="_blank" 
           rel="noopener noreferrer"
           class="social-link instagram">
           <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
             <path d="M12 2.163c3.204 0 3.584.012 
                      4.85.07 3.252.148 4.771 1.691 
                      4.919 4.919.058 1.265.069 
                      1.645.069 4.849 0 3.205-.012 
                      3.584-.069 4.849-.149 3.225-1.664 
                      4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 
                      0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 
                      0-3.204.013-3.583.07-4.849.149-3.227 
                      1.664-4.771 4.919-4.919 1.266-.057 
                      1.645-.069 4.849-.069zM12 
                      7.001a5 5 0 1 0 0 10 5 5 0 
                      0 0 0-10zm6.406-2.684a1.44 
                      1.44 0 1 0 0 2.88 1.44 1.44 
                      0 0 0 0-2.88z"/>
           </svg>
        </a>
        <button *ngIf="userProfile.socialLinks?.ig && isOwnProfile" 
                class="edit-social-btn" 
                (click)="editSingleSocial('ig')"
                title="Edit Instagram link">
          ‚úèÔ∏è
        </button>
      </div>
      
      <!-- LinkedIn -->
      <div class="social-link-wrapper">
        <a *ngIf="userProfile.socialLinks?.linkedin" 
           [href]="getSocialUrl('linkedin', userProfile.socialLinks.linkedin)" 
           target="_blank" 
           rel="noopener noreferrer"
           class="social-link linkedin">
           <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
             <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 
                      0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 
                      1.637-1.85 3.37-1.85 3.601 0 
                      4.267 2.37 4.267 5.455v6.286zM5.337 
                      7.433c-1.144 0-2.063-.926-2.063-2.065 
                      0-1.138.92-2.063 2.063-2.063 
                      1.14 0 2.064.925 2.064 
                      2.063 0 1.139-.925 2.065-2.064 
                      2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 
                      0H1.771C.792 0 0 .774 0 1.729v20.542C0 
                      23.227.792 24 1.771 24h20.451C23.2 
                      24 24 23.227 24 22.271V1.729C24 
                      .774 23.2 0 22.222 0h.003z"/>
           </svg>
        </a>
        <button *ngIf="userProfile.socialLinks?.linkedin && isOwnProfile" 
                class="edit-social-btn" 
                (click)="editSingleSocial('linkedin')"
                title="Edit LinkedIn link">
          ‚úèÔ∏è
        </button>
      </div>
      
      <!-- Add new social link button -->
      <button *ngIf="isOwnProfile && canAddMoreSocials()" 
              class="add-social-btn"
              (click)="startEditingSocial()"
              title="Add more social links">
        <svg class="add-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
        <span>Add social link</span>
      </button>
    </div>
  </div>

  <!-- Edit Mode -->
  <div *ngIf="editingSocial" class="social-edit-form">
    <div class="form-header">
      <h5 class="form-title">
        {{ editingSingleSocial ? 'Edit Social Link' : 'Social Links' }}
      </h5>
      <p class="form-subtitle">Connect with your audience on social media</p>
    </div>

    <!-- Facebook Input -->
    <div class="social-input-group" *ngIf="!editingSingleSocial || editingSingleSocial === 'fb'">
      <label for="facebook-input" class="social-input-label">
        <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 
                   5.373-12 12c0 5.99 4.388 10.954 10.125 
                   11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 
                   1.792-4.669 4.533-4.669 1.312 0 
                   2.686.235 2.686.235v2.953H15.83c-1.491 
                   0-1.956.925-1.956 1.874v2.25h3.328l-.532 
                   3.47h-2.796v8.385C19.612 23.027 
                   24 18.062 24 12.073z"/>
        </svg>
        Facebook
      </label>
      <div class="input-with-actions">
        <input 
          id="facebook-input"
          [(ngModel)]="tempSocialLinks.fb" 
          class="social-input"
          placeholder="facebook.com/yourprofile or @username"
          maxlength="100"
          (input)="onSocialInputChange('fb', $event)"
          #facebookInput>
        <button *ngIf="tempSocialLinks.fb" 
                type="button" 
                class="clear-input-btn"
                (click)="clearSocialInput('fb')"
                title="Clear">
          ‚úï
        </button>
      </div>
    </div>

    <!-- Instagram Input -->
    <div class="social-input-group" *ngIf="!editingSingleSocial || editingSingleSocial === 'ig'">
      <label for="instagram-input" class="social-input-label">
        <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2.163c3.204 0 3.584.012 
                   4.85.07 3.252.148 4.771 1.691 
                   4.919 4.919.058 1.265.069 
                   1.645.069 4.849 0 3.205-.012 
                   3.584-.069 4.849-.149 3.225-1.664 
                   4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 
                   0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 
                   0-3.204.013-3.583.07-4.849.149-3.227 
                   1.664-4.771 4.919-4.919 1.266-.057 
                   1.645-.069 4.849-.069zM12 
                   7.001a5 5 0 1 0 0 10 5 5 0 
                   0 0 0-10zm6.406-2.684a1.44 
                   1.44 0 1 0 0 2.88 1.44 1.44 
                   0 0 0 0-2.88z"/>
        </svg>
        Instagram
      </label>
      <div class="input-with-actions">
        <input 
          id="instagram-input"
          [(ngModel)]="tempSocialLinks.ig" 
          class="social-input"
          placeholder="instagram.com/username or @username"
          maxlength="100"
          (input)="onSocialInputChange('ig', $event)"
          #instagramInput>
        <button *ngIf="tempSocialLinks.ig" 
                type="button" 
                class="clear-input-btn"
                (click)="clearSocialInput('ig')"
                title="Clear">
          ‚úï
        </button>
      </div>
    </div>

    <!-- LinkedIn Input -->
    <div class="social-input-group" *ngIf="!editingSingleSocial || editingSingleSocial === 'linkedin'">
      <label for="linkedin-input" class="social-input-label">
        <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 
                   0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 
                   1.637-1.85 3.37-1.85 3.601 0 
                   4.267 2.37 4.267 5.455v6.286zM5.337 
                   7.433c-1.144 0-2.063-.926-2.063-2.065 
                   0-1.138.92-2.063 2.063-2.063 
                   1.14 0 2.064.925 2.064 
                   2.063 0 1.139-.925 2.065-2.064 
                   2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 
                   0H1.771C.792 0 0 .774 0 1.729v20.542C0 
                   23.227.792 24 1.771 24h20.451C23.2 
                   24 24 23.227 24 22.271V1.729C24 
                   .774 23.2 0 22.222 0h.003z"/>
        </svg>
        LinkedIn
      </label>
      <div class="input-with-actions">
        <input 
          id="linkedin-input"
          [(ngModel)]="tempSocialLinks.linkedin" 
          class="social-input"
          placeholder="linkedin.com/in/yourprofile or linkedin.com/company/yourcompany"
          maxlength="100"
          (input)="onSocialInputChange('linkedin', $event)"
          #linkedinInput>
        <button *ngIf="tempSocialLinks.linkedin" 
                type="button" 
                class="clear-input-btn"
                (click)="clearSocialInput('linkedin')"
                title="Clear">
          ‚úï
        </button>
      </div>
    </div>

    <div class="edit-actions">
      <button class="save-btn" 
              (click)="saveSocialLinks()" 
              [disabled]="savingProfile">
        {{ savingProfile ? 'Saving...' : 'Save' }}
      </button>
      <button class="cancel-btn" (click)="cancelSocialEdit()">Cancel</button>
      <button *ngIf="editingSingleSocial" 
              class="delete-btn" 
              (click)="deleteSocialLink(editingSingleSocial)"
              title="Remove this social link">
        Remove Link
      </button>
    </div>
  </div>
</div>



            
            <!-- Stats with Loading State -->
            <div class="user-stats" *ngIf="!loadingStats; else statsLoader">
  <div class="stat" *ngIf="isOwnProfile">
    <span class="stat-number">{{ drafts.length }}</span>
    <span class="stat-label">Drafts</span>
  </div>
  <div class="stat">
    <span class="stat-number">{{ stories.length }}</span>
    <span class="stat-label">Articles</span>
  </div>
  <div class="stat" *ngIf="isOwnProfile">
    <span class="stat-number">{{ bookmarks.length }}</span>
    <span class="stat-label">Bookmarks</span>
  </div>
  <div class="stat">
    <span class="stat-number">{{ formatNumber(userProfile.nbFollowers) || 0 }}</span>
    <span class="stat-label">Followers</span>
  </div>
  <div class="stat">
    <span class="stat-number">{{ formatNumber(userProfile.nbFollowed) || 0 }}</span>
    <span class="stat-label">Following</span>
  </div>
  <div class="stat" *ngIf="userProfile.nbViews > 0">
    <span class="stat-number">{{ formatNumber(userProfile.nbViews) }}</span>
    <span class="stat-label">Total Views</span>
  </div>
  <div class="stat" *ngIf="userProfile.nbUpvotes > 0">
    <span class="stat-number">{{ formatNumber(userProfile.nbUpvotes) }}</span>
    <span class="stat-label">Total Votes</span>
  </div>
</div>

            <!-- Stats Loading Template -->
            <ng-template #statsLoader>
              <div class="stats-skeleton">
                <div class="skeleton-item" *ngFor="let i of [1,2,3,4,5]"></div>
              </div>
            </ng-template>

            <!-- Follow Button (only show if viewing another user's profile) -->
            <div class="follow-section" *ngIf="!isOwnProfile">
              <button 
                class="follow-btn" 
                [class.following]="isFollowing"
                (click)="toggleFollow()"
                [disabled]="followLoading">
                <span *ngIf="followLoading" class="button-spinner"></span>
                {{ followLoading ? 'Loading...' : (isFollowing ? 'Following' : 'Follow') }}
              </button>
            </div>
          </div>
        </div>

        <!-- Motivation Banner -->
        <div class="motivation-banner" *ngIf="getMotivationMessage() && isOwnProfile">
  <div class="motivation-content">
    <span class="motivation-icon">‚ú®</span>
    <span class="motivation-text">{{ getMotivationMessage() }}</span>
  </div>
</div>

        <!-- Badges Section with Loading State -->
        <div class="badges-section" *ngIf="!loadingBadges && badges.length > 0 && badgesInitialized; else badgesLoader">
  <h3 class="section-title">
    Achievements
    <span class="achievement-count">({{ unlockedBadgesCount }}/{{ totalBadgesCount }})</span>
  </h3>
  <div class="badges-grid">
    <div 
      *ngFor="let badge of badges; trackBy: trackByFn" 
      class="badge-item"
      [class.unlocked]="badge.unlocked"
      [class.in-progress]="!badge.unlocked && badge.progress && badge.progress > 0"
      [title]="badge.description">
      <div class="badge-icon">{{ badge.icon }}</div>
      <div class="badge-info">
        <div class="badge-name">{{ badge.name }}</div>
        <div class="badge-description">{{ badge.description }}</div>
        <!-- Progress bar for badges with requirements -->
        <div class="badge-progress" *ngIf="!badge.unlocked && badge.progress !== undefined && badge.requirement">
          <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="(badge.progress / badge.requirement) * 100"></div>
          </div>
          <span class="progress-text">{{ badge.progress }}/{{ badge.requirement }}</span>
        </div>
        <div class="badge-unlocked" *ngIf="badge.unlocked">
          <span class="unlock-icon">‚úì</span> Unlocked
        </div>
      </div>
    </div>
  </div>
</div>

        <!-- Badges Loading Template -->
        <ng-template #badgesLoader>
          <div class="badges-section" *ngIf="loadingBadges">
            <h3 class="section-title">Achievements</h3>
            <div class="badges-skeleton">
              <div class="badge-skeleton" *ngFor="let i of [1,2,3,4]"></div>
            </div>
          </div>
        </ng-template>

        <!-- Community Impact Section -->
        <div class="community-section" *ngIf="userProfile.nbViews || userProfile.nbUpvotes">
          <h3 class="section-title">Community Impact</h3>
          <div class="impact-stats">
            <div class="impact-stat">
              <span class="impact-number">{{ formatNumber(userProfile.nbViews) }}</span>
              <span class="impact-label">Total reads across stories</span>
            </div>
            <div class="impact-stat">
              <span class="impact-number">{{ formatNumber(userProfile.nbUpvotes) }}</span>
              <span class="impact-label">Total votes on stories</span>
            </div>
          </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs-container">
          <div class="tabs">
            <button 
              class="tab"
              [class.active]="activeTab === 'drafts'"
              (click)="setActiveTab('drafts')"
              *ngIf="isOwnProfile">
              Drafts ({{ drafts.length }})
            </button>
            <button 
              class="tab"
              [class.active]="activeTab === 'articles'"
              (click)="setActiveTab('articles')">
              Articles ({{ stories.length }})
            </button>
            <button 
              class="tab"
              [class.active]="activeTab === 'bookmarks'"
              (click)="setActiveTab('bookmarks')"
              *ngIf="isOwnProfile">
              Bookmarks ({{ bookmarks.length }})
            </button>
          </div>
        </div>

        <!-- Content Sections -->
        <div class="content-container">
          <!-- Drafts Section -->
          <div *ngIf="activeTab === 'drafts'" class="content-section">
            <div *ngIf="activeTab === 'drafts' && drafts.length === 0" class="empty-state">
  <div class="empty-icon">üìù</div>
  <h3>{{ getEmptyStateMessage('drafts').title }}</h3>
  <p>{{ getEmptyStateMessage('drafts').subtitle }}</p>
  <div class="empty-rewards">
    <div class="reward-item">
      <span class="reward-icon">üéØ</span>
      <span class="reward-text">+10 XP for creating every draft</span>
    </div>
    <div class="reward-item" *ngIf="this.userProfile.streaks == 0">
      <span class="reward-icon">üìÖ</span>
      <span class="reward-text">Start your writing streak!</span>
    </div>
  </div>
  <button *ngIf="getEmptyStateMessage('drafts').action" 
          class="create-btn" 
          (click)="handleEmptyStateAction('drafts')">
    {{ getEmptyStateMessage('drafts').action }}
  </button>
</div>
            <div *ngFor="let draft of drafts; trackBy: trackByFn" class="content-card">
              <div class="card-header">
                <h2 class="card-title">{{ draft.emoji }}</h2>
                <h3 class="card-title">{{ draft.title }}</h3>
              </div>
              <p class="card-excerpt">{{ getExcerpt(draft.content) }}</p>
              <div class="card-footer">
                <span class="card-date">Last modified {{ formatDate(draft.updatedAt) }}</span>
                <div class="card-stats">
                  <span class="stat-item">üìù {{ draft.stats.wordCount || 0 }} words</span>
                  <span class="stat-item">‚è± {{ draft.stats.readTime || 1 }} min read</span>
                </div>
                <div class="card-actions">
  <button class="action-btn" (click)="editDraft(draft)">
    <span class="btn-icon">‚úèÔ∏è</span>
    Edit
  </button>
  <button class="action-btn publish" 
          (click)="publishDraft(draft)"
          [disabled]="deletingItem === draft.id">
    <span class="btn-icon" *ngIf="deletingItem !== draft.id">üöÄ</span>
    <span class="btn-spinner" *ngIf="deletingItem === draft.id"></span>
    {{ deletingItem === draft.id ? 'Publishing...' : 'Publish' }}
    <span class="btn-reward" *ngIf="deletingItem !== draft.id">+25 XP</span>
  </button>
  <button class="action-btn danger" 
          [disabled]="deletingItem === draft.id"
          (click)="deleteDraft(draft)">
    <span class="btn-icon" *ngIf="deletingItem !== draft.id">üóë</span>
    <span class="btn-spinner" *ngIf="deletingItem === draft.id"></span>
    {{ deletingItem === draft.id ? 'Deleting...' : 'Delete' }}
  </button>
</div>
              </div>
            </div>
          </div>

          <!-- Articles Section -->
          <div *ngIf="activeTab === 'articles'" class="content-section">
            <div *ngIf="activeTab === 'articles' && stories.length === 0" class="empty-state">
  <div class="empty-icon">üìö</div>
  <h3>{{ getEmptyStateMessage('articles').title }}</h3>
  <p>{{ getEmptyStateMessage('articles').subtitle }}</p>
  <div class="empty-rewards" *ngIf="isOwnProfile">
    <div class="reward-item">
      <span class="reward-icon">üöÄ</span>
      <span class="reward-text">+25 XP for publishing your first story</span>
    </div>
    <div class="reward-item">
      <span class="reward-icon">üèÜ</span>
      <span class="reward-text">Unlock the "Author" achievement</span>
    </div>
  </div>
  <button *ngIf="isOwnProfile" 
          class="create-btn" 
          (click)="handleEmptyStateAction('articles')">
    Start Writing
  </button>
</div>
            <div *ngFor="let story of stories; trackBy: trackByFn" class="content-card">
              <div class="card-header">
                <h2 class="card-title">{{ story.emoji }}</h2>
                <h3 class="card-title">{{ story.title }}</h3>
              </div>
              <p class="card-excerpt">{{ getExcerpt(story.content) }}</p>
              <div class="bookmark-tags" *ngIf="story.tags && story.tags.length > 0">
                <span *ngFor="let tag of story.tags" class="tag">{{ tag }}</span>
              </div>
              <div class="card-footer">
                <span class="card-date">Published {{ formatDate(story.createdAt) }}</span>
                <div class="card-stats">
                  <span class="stat-item">üëÅ {{ story.stats.readCount || 0 }} views</span>
                  <span class="stat-item">‚≠ê {{ story.stats.voteCount || 0 }} votes</span>
                  <span class="stat-item">‚è± {{ story.stats.readTime || 1 }} min read</span>
                </div>
                <div class="card-actions">
                  <a style="text-decoration: none;" class="action-btn" [href]="'/story/'+story.id">Read</a>
                  <button *ngIf="isOwnProfile" 
                class="action-btn danger" 
                [disabled]="deletingItem === story.id"
                (click)="deleteStory(story)">
          <span class="btn-icon" *ngIf="deletingItem !== story.id">üóë</span>
          <span class="btn-spinner" *ngIf="deletingItem === story.id"></span>
          {{ deletingItem === story.id ? 'Deleting...' : 'Delete' }}
        </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Bookmarks Section -->
          <div *ngIf="activeTab === 'bookmarks'" class="content-section">
            <div *ngIf="bookmarks.length === 0" class="empty-state">
              <div class="empty-icon">üîñ</div>
              <h3>{{ getEmptyStateMessage('bookmarks').title }}</h3>
              <p>{{ getEmptyStateMessage('bookmarks').subtitle }}</p>
              <div class="empty-rewards">
                <span class="reward-text">+5 XP for each bookmark!</span>
              </div>
            </div>
            <div *ngFor="let bookmark of bookmarks; trackBy: trackByFn" class="content-card">
              <div class="card-header">
                <h3 class="card-title">{{ bookmark.title }}</h3>
                <span class="card-meta">by {{ bookmark.authorName }}</span>
              </div>
              <div class="bookmark-tags" *ngIf="bookmark.category">
                <span class="tag">{{ bookmark.category }}</span>
              </div>
              <div class="card-footer">
                <span class="card-date">Saved {{ formatDate(bookmark.createdAt) }}</span>
                <div class="card-actions">
                  <button class="action-btn" (click)="readBookmark(bookmark)">Read</button>
                  <button class="action-btn danger" 
                          [disabled]="deletingItem === bookmark.id">
                    {{ deletingItem === bookmark.id ? 'Removing...' : 'Remove' }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Error State -->
      <div *ngIf="!loading && !userProfile" class="error-state">
        <div class="error-icon">üòî</div>
        <h3>Profile not found</h3>
        <p>There was an error loading this profile. Please try again.</p>
        <button class="retry-btn" (click)="loadProfileDataOptimized()">
          <span class="retry-icon">üîÑ</span>
          Try Again
        </button>
      </div>
    </div>